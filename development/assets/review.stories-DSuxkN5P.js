import{r as u,j as t,R,_ as d,L as j}from"./index-BT1mXKY7.js";import{a as T}from"./app-ids-DfxPsmPu.js";import{u as x}from"./review-card-G07YOTxn.js";import{a as W,b as _,s as S}from"./index-DeMZBYWP.js";import{u as D,R as V}from"./review-context-Dn3AEYUD.js";import{R as L}from"./review-head-BB4pVQEM.js";import{R as y}from"./review-description-DbPSx00a.js";import{R as $}from"./review-card-slider-DpiADDE_.js";import{A as I}from"./review-link-1JQJ4vq1.js";import{P as O}from"./decorators-C_IKtT7k.js";import"./star-icon-DHAZlpGI.js";import"./right-arrow-icon-CG7ULi93.js";import"./text-link-arrow-ClgkoDmm.js";import"./review-filler-card-DY1wQ5i6.js";const P=({codes:e,appId:o})=>{const[i,r]=u.useState(null),[s,a]=u.useState(!0);return u.useEffect(()=>{let l=!0;return a(!0),W({appId:o,countryCode:e.countryCode||"us"}).then(n=>_({reviewData:n.feed.entry})).then(n=>S({validatedData:n,lang:e.languageCode||"en"})).then(n=>{l&&(r(n),a(!1))}).catch(()=>{l&&_({reviewData:[]}).then(n=>{r(n),a(!1)})}),()=>{l=!1}},[o,e.countryCode,e.languageCode]),{reviews:i,isLoading:s}};function B({head:e,description:o,link:i,slider:r}){const{themeColor:s="#1686FF"}=D();return t.jsxs(b,{children:[t.jsxs("header",{className:"review__header",children:[e,i]}),o,r]})}function H({head:e,description:o,link:i,slider:r}){return t.jsxs(b,{children:[t.jsx("header",{className:"review__header",children:e}),o,r,t.jsx("footer",{className:"review__link-wrapper pt-4",children:i})]})}function b({children:e}){return t.jsx("section",{children:t.jsx("div",{className:"row review py-5",children:e})})}function A({direction:e,onClick:o,disabled:i,themeColor:r}){return x("(max-width: 991px)")?null:t.jsx("button",{onClick:o,className:`review-pagination__arrow review-pagination__arrow--${e}`,style:{backgroundColor:r},"aria-label":`${e==="left"?"Previous":"Next"} page`,disabled:i,children:t.jsx("img",{src:`/img/slider-pagination-arrow-${e==="left"?"02":"01"}.svg`,alt:""})})}function K({totalPages:e,currentPage:o,onPageChange:i}){const{themeColor:r="#1686FF"}=D(),s=()=>{o>0&&i(o-1)},a=()=>{o<e-1&&i(o+1)},l=n=>{n!==o&&i(n)};return t.jsxs("div",{className:"review-pagination",children:[t.jsx(A,{direction:"left",onClick:s,disabled:o===0,themeColor:r}),t.jsx("div",{className:"review-pagination__dots",children:Array.from({length:e}).map((n,c)=>t.jsx("button",{onClick:()=>l(c),className:"review-pagination__dot",style:{backgroundColor:c===o?r:`${r}55`,transform:c===o?"scale(1.25)":"scale(1)",opacity:c===o?1:.5},"aria-label":`Go to page ${c+1}`},c))}),t.jsx(A,{direction:"right",onClick:a,disabled:o===e-1,themeColor:r})]})}function G(e,o){const[i,r]=u.useState(0),s=u.useMemo(()=>e!=null&&e.length?Math.ceil(e.length/o):0,[e,o]),a=u.useMemo(()=>{if(!(e!=null&&e.length))return[];const n=i*o;return e.slice(n,n+o)},[e,i,o]);return{currentPage:i,totalPages:s,paginatedReviews:a,goToPage:n=>{n<0||n>=s||r(n)}}}const X=991,Q=1400;function q(e){return"filler"in e}function z({text:e,appId:o,codes:i,themeColor:r="#1686FF",hasUnderlineHover:s=!0}){const a=x(`(max-width: ${X}px)`),l=x(`(max-width: ${Q}px)`),{reviews:n,isLoading:c}=P({codes:i,appId:o}),h=R.useMemo(()=>(n==null?void 0:n.filter(m=>!q(m)))??[],[n]),f=R.useMemo(()=>a?1:l?2:3,[a,l]),{currentPage:p,totalPages:g,paginatedReviews:w,goToPage:E}=G(h,f),N=R.useMemo(()=>{const m=[...w],v=f-m.length;if(v>0){const k=Array.from({length:v},()=>({filler:!0}));m.push(...k)}return m},[w,f]),M=!c&&!a&&h.length>4,C=t.jsxs(t.Fragment,{children:[t.jsx($,{reviews:N,currentPage:p,onPageChange:E,totalPages:g,hasUnderlineHover:s}),M&&t.jsx(K,{totalPages:g,currentPage:p,onPageChange:E})]});return!n||!o?t.jsx(t.Fragment,{}):t.jsx(V.Provider,{value:{data:{reviews:n,appId:o,countryCode:i.countryCode},text:e,themeColor:r},children:a?t.jsx(H,{head:t.jsx(L,{}),description:t.jsx(y,{}),link:t.jsx(I,{hasUnderlineHover:s}),slider:C}):t.jsx(B,{head:t.jsx(L,{}),description:t.jsx(y,{}),link:t.jsx(I,{hasUnderlineHover:s}),slider:C})})}const de={title:"Prototype"},F=()=>t.jsx(z,{appId:T.vitamin,codes:{countryCode:j.countryCode,languageCode:j.language},text:{head:d("REVIEW.HEAD"),description:d("REVIEW.DESCRIPTION"),link:d("REVIEW.LINK_ALL_REVIEWS"),readMoreLink:d("REVIEW.READ_MORE_LINK"),fillerCard:{head:[d("REVIEW.FILLER_CARD.HEAD1"),d("REVIEW.FILLER_CARD.HEAD2"),d("REVIEW.FILLER_CARD.HEAD3")],link:d("REVIEW.FILLER_CARD.LINK")}},themeColor:"#1686FF"});F.decorators=[O];F.storyName="Review";typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{F as ReviewStory,de as default};
