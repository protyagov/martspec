var x=s=>{throw TypeError(s)};var E=(s,e,t)=>e.has(s)||x("Cannot "+t);var a=(s,e,t)=>(E(s,e,"read from private field"),t?t.call(s):e.get(s)),g=(s,e,t)=>e.has(s)?x("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),c=(s,e,t,r)=>(E(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t),l=(s,e,t)=>(E(s,e,"access private method"),t);import{R as I}from"./index-C_XspqlI.js";import{a as S}from"./app-ids-DfxPsmPu.js";var p;class C{constructor(){g(this,p);this.getReviewData=async e=>await(await fetch(a(this,p).call(this,e))).json(),c(this,p,({appId:e,dataType:t="json",countryCode:r="us",page:i=1})=>`https://itunes.apple.com/${r}/rss/customerreviews/page=${i}/id=${e}/sortBy=mostRecent/${t}?l=en&cc=gb`)}}p=new WeakMap;const{getReviewData:D}=new C;var h,d,y,u,f,v;class H{constructor(){g(this,h);g(this,d);g(this,y);g(this,u);g(this,f);g(this,v);this.validateReviewMsg=async({data:e,settings:t})=>{const r=getComputedStyle(e.origElem),i=a(this,y).call(this,{data:{origElemStyles:r}}),o=a(this,f).call(this,{data:{origElemStyles:r},settings:t}),w=e.origElem.scrollHeight>o;if(e.origElem.dataset.overflowFlag==="true"||w){e.origElem.dataset.overflowFlag="true",document.body.appendChild(i);const L=await a(this,h).call(this,{data:{...e,tempElem:i},settings:{maxHeight:o}});document.body.removeChild(i);const $=a(this,u).call(this,t.endElem).length;return{overflowFlag:!0,content:[await a(this,d).call(this,{data:e,settings:{endElemLength:$,truncationIndex:L}}),t.endElem]}}return e.origElem.dataset.overflowFlag="false",{overflowFlag:!1,content:[e.origMsg]}},c(this,h,async({data:e,settings:t})=>{if(!e.origMsg.length)return 0;let r=0,i=e.origMsg.length-1;for(;r<=i;){const o=Math.floor((r+i)/2),w=e.origMsg.substring(0,o);e.tempElem.textContent=w,e.tempElem.scrollHeight<=t.maxHeight?r=o+1:i=o-1}return i}),c(this,d,async({data:e,settings:t})=>{if(t.truncationIndex===0)return e.origMsg;const r=t.truncationIndex-t.endElemLength,i=e.origMsg.lastIndexOf(" ",r);return i<0?e.origMsg.substring(0,r):e.origMsg.substring(0,i).replace(new RegExp("\\p{P}+$","gu"),"").trim()}),c(this,y,({data:e})=>{const t=document.createElement("div");return t.style.position="absolute",t.style.visibility="hidden",t.style.overflow="hidden",t.style.display="inline-block",t.style.whiteSpace="pre-wrap",t.style.fontSize=e.origElemStyles.fontSize,t.style.lineHeight=e.origElemStyles.lineHeight,t.style.fontFamily=e.origElemStyles.fontFamily,t.style.padding=e.origElemStyles.padding,t.style.margin=e.origElemStyles.margin,t.style.border=e.origElemStyles.border,t.style.maxWidth=e.origElemStyles.width,t.style.maxHeight=e.origElemStyles.height,t}),c(this,u,e=>typeof e=="string"?e:typeof e=="number"?e.toString():I.isValidElement(e)?I.Children.toArray(e.props.children).map(a(this,u)).join(""):""),c(this,f,({data:e,settings:t})=>t.rows*a(this,v).call(this,{data:{origElemStyles:e.origElemStyles}})),c(this,v,({data:e})=>parseFloat(e.origElemStyles.lineHeight)||parseFloat(e.origElemStyles.fontSize)),this.validateReviewData=async({reviewData:e})=>e?Array.isArray(e)?e:[e]:[]}}h=new WeakMap,d=new WeakMap,y=new WeakMap,u=new WeakMap,f=new WeakMap,v=new WeakMap;const{validateReviewData:U,validateReviewMsg:J}=new H;var n,R,b,M,m,F;class A{constructor(){g(this,n);this.sortReviews=async({validatedData:e,lang:t})=>e.sort((r,i)=>l(this,n,m).call(this,r)&&l(this,n,m).call(this,i)?0:l(this,n,m).call(this,r)?1:l(this,n,m).call(this,i)?-1:l(this,n,R).call(this,r,i,t))}}n=new WeakSet,R=function(e,t,r){const i=l(this,n,M).call(this,e,t);return i!==0?i:l(this,n,b).call(this,e,t,r)},b=function(e,t,r){const i=l(this,n,F).call(this,e.content.label,r),o=l(this,n,F).call(this,t.content.label,r);return i===o?0:i&&!o?-1:1},M=function(e,t){const r=parseInt(e["im:rating"].label);return parseInt(t["im:rating"].label)-r},m=function(e){return"filler"in e},F=function(e,t){const i={ar:/[\u0621-\u064A\u0660-\u0669]/,en:/[a-zA-Z]/,ru:/[а-яА-ЯёЁ]/,de:/[äöüß]/,hi:/[अ-ह]/,es:/[ñáéíóúü]/,fr:/[àâçéèêëîïôûù]/,zh:/[\u4E00-\u9FFF]/,ja:/[\u3040-\u30FF\uFF00-\uFFEF]/,pt:/[ãáâéêíóôú]/,uk:/[єіїґ]/}[t];return i?i.test(e):!1};const{sortReviews:V}=new A;class T{constructor(){this.getAppId=()=>{const t=new URL(document.URL).pathname.split("/");let r;for(r in S)if(t.includes(r))return S[r];throw new Error(`ID NOT FOUND, pathnameItems:${JSON.stringify(t)}, appIds: ${JSON.stringify(S)}`)},this.getAppStoreLink=({data:e,option:t})=>`https://apps.apple.com/${e.countryCode||"us"}/app/id${e.appId}${t&&`?${t}`}`}}const{getAppId:B,getAppStoreLink:P}=new T;export{D as a,U as b,P as g,V as s,J as v};
