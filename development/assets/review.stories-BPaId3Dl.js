import{r as o,j as e,L as l,_ as d}from"./index-Cwf6pIPx.js";import{a as E}from"./app-ids-CkH1oDs0.js";import{g as j,v as w,s as p,a as g,R as D,S as L,A as u}from"./review-link-J9fgkBtr.js";import{u as _,R as C}from"./review-context-CwcebO9T.js";import{R as m}from"./review-head-BUOviZwH.js";import{R as v}from"./review-description-BnuzerIj.js";import{S as I}from"./star-icon-CbxCxHiD.js";import"./right-arrow-icon-C3sz4llq.js";import"./text-link-arrow-C3VVeyBc.js";const h=i=>{const[s,t]=o.useState(!1);return o.useEffect(()=>{t(window.matchMedia(i).matches)},[]),o.useEffect(()=>{const a=window.matchMedia(i),r=n=>t(n.matches);return a.addEventListener("change",r),()=>a.removeEventListener("change",r)},[]),s},S=({codes:i,arrLength:s=3,appId:t})=>{const[a,r]=o.useState(null);return o.useEffect(()=>{j({appId:t,countryCode:i.countryCode||"us"}).then(n=>w({reviewData:n.feed.entry,arrLength:s})).then(n=>p({validatedData:n,lang:i.languageCode||"en"})).then(n=>r(n)).catch(()=>w({reviewData:[],arrLength:s}).then(n=>r(n)))},[]),{reviews:a}};function y({head:i,description:s,link:t,slider:a}){return e.jsxs(x,{children:[e.jsxs("header",{className:"review__header",children:[i,t]}),s,a]})}function A({head:i,description:s,link:t,slider:a}){return e.jsxs(x,{children:[e.jsx("header",{className:"review__header",children:i}),s,a,e.jsx("footer",{className:"review__link-wrapper pt-4",children:t})]})}function x({children:i}){return e.jsx("section",{children:e.jsx("div",{className:"row review py-5",children:i})})}const N=(i,s)=>{let t;return(...a)=>{t&&clearTimeout(t),t=setTimeout(()=>i(...a),s)}},T=(i=1e3)=>{const[s,t]=o.useState({width:window.innerWidth,height:window.innerHeight});return o.useEffect(()=>{const a=N(()=>{t({width:window.innerWidth,height:window.innerHeight})},i);return window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[i]),s},W=({data:i,settings:s})=>{const t=o.useRef(null),a=T(s.resizeDelay),[r,n]=o.useState({overflowFlag:!1,content:[i.origMsg]});return o.useLayoutEffect(()=>{const c=t.current;c&&g({data:{...i,origElem:c},settings:s}).then(f=>n(f))},[a]),{validatedData:r,reviewTextRef:t}},k=i=>new Date(i).toLocaleDateString("ru-RU");function M({reviewerNickname:i,createdDate:s,reviewText:t,rating:a}){const{reviewTextRef:r,validatedData:n}=W({data:{origMsg:t},settings:{rows:8,resizeDelay:100,endElem:e.jsx("span",{children:"..."},t)}});return e.jsxs("li",{className:"review-card",children:[e.jsxs("header",{className:"review-card__header",children:[e.jsxs("div",{className:"review-card__header-main",children:[e.jsx("h3",{children:i}),e.jsxs("span",{className:"review-card__header-rating",children:[e.jsx(I,{}),a,",0"]})]}),e.jsx("time",{dateTime:s,children:k(s)})]}),e.jsx("p",{ref:r,children:n.content})]})}function R(){const{data:i,text:s}=_();return e.jsx("ul",{className:"review__list",children:i.reviews.map((t,a)=>"filler"in t?e.jsx(D,{link:e.jsx(L,{}),posIndex:a},s.fillerCard.head[a]):e.jsx(M,{createdDate:t.updated.label,reviewText:t.content.label,reviewerNickname:t.author.name.label,rating:t["im:rating"].label},t.id.label))})}const V=992,b=1400;function z({text:i,appId:s,codes:t}){const a=h(`(max-width: ${V}px)`),r=h(`(max-width: ${b}px)`),n=a?1:r?2:3,{reviews:c}=S({codes:t,arrLength:n,appId:s});return!c||!s?e.jsx(e.Fragment,{}):e.jsx(C.Provider,{value:{data:{reviews:c.slice(0,n),appId:s,countryCode:t.countryCode},text:i},children:a?e.jsx(A,{head:e.jsx(m,{}),description:e.jsx(v,{}),link:e.jsx(u,{}),slider:e.jsx(R,{})}):e.jsx(y,{head:e.jsx(m,{}),description:e.jsx(v,{}),link:e.jsx(u,{}),slider:e.jsx(R,{})})})}const U={title:"Prototype"},F=()=>e.jsx(z,{appId:E.vitamin,codes:{countryCode:l.countryCode,languageCode:l.language},text:{head:d("REVIEW.HEAD"),description:d("REVIEW.DESCRIPTION"),link:d("REVIEW.LINK_ALL_REVIEWS"),fillerCard:{head:[d("REVIEW.FILLER_CARD.HEAD1"),d("REVIEW.FILLER_CARD.HEAD2"),d("REVIEW.FILLER_CARD.HEAD3")],link:d("REVIEW.FILLER_CARD.LINK")}}});F.storyName="Review";typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{F as ReviewStory,U as default};
